#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass IEEEtran
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Spatial Pattern Optimization for Intra-Cortical Stimulation with High-Density
 Multi-Electrode Arrays
\end_layout

\begin_layout Author
Alessio Paolo Buccino, Tristan Stöber, Gert Cauwenberghs, Philipp Häfliger
\end_layout

\begin_layout Abstract
Recent advances in fabrication and processing techniques have made possible
 to realize Multi-Electrode Arrays (MEA) with a very high density (HD).
 Such systems not only can be used to perform HD 
\emph on
in-vivo
\emph default
 recording, but they could also be used to actively stimulate neural tissue
 with high focus.
 While many studies have shown how HD MEA could help in identifying the
 neuron soma position and reconstruct the axonal arbor, here we aim at optimizin
g the stimulation capabilities of the MEA.
 We assumed that an estimate of the neuron position and axon hillock direction
 is available and we used genetic algorithm to tailor the potential generated
 by the MEA in order to activate one or more target neurons by keeping the
 non-target or surrounding neurons at rest.
 We showed that with this approach it is possible to selectively excite
 neurons in a more robust adn effective way with respect to conventional
 monopolar and bipolar stimulation.
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
While there are many examples of successful very high density (HD) Multi-Electro
de Arrays (MEA) developed for 
\emph on
in-vitro
\emph default
 recordings 
\begin_inset CommandInset citation
LatexCommand cite
key "berdondini2014active"

\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "muller2015high"

\end_inset

, the challenge of 
\emph on
in-vivo
\emph default
 recordings lies in the fact that there are much stricter size and power
 consumption limitations.
 New prototypes have been developed in the last years which attempt to overcome
 this limitation and to reach 
\emph on
in-vitro
\emph default
 high density also for
\emph on
 in-vivo
\emph default
 systems.
 The integration of HD MEA in CMOS technology can be achieved through the
 use of Electrolyte-Oxide-Semiconductor Field-Effect-Transistor (EOSFET),
 in which the gate of the transistor itself serves as sensor and it is coupled
 through a dielectric layer.
 In 
\begin_inset CommandInset citation
LatexCommand cite
key "schroder2015cmos"

\end_inset

 a 16x16 matrix of electrodes with 15 μm pitch was fabricated on a single
 shank of 300 μm width and it was able to record HD Local Field Potentials.
 A great improvement is represented by the integration of recording and
 stimulation that could allow closed-loop experiments, with simultaneous
 recording and stimulation (as in 
\begin_inset CommandInset citation
LatexCommand cite
key "ha2014energy"

\end_inset

).
 
\begin_inset Newline newline
\end_inset

A system capable of both recording and stimulating neural tissue is very
 interesting especially in order to perform closed-loop experiments, in
 which stimulation is triggered from certain features extracted from recording
 the same neural sites.
 Such implants have the capability of inducing neuroplasticity 
\emph on
in-vivo
\emph default
 
\begin_inset CommandInset citation
LatexCommand cite
key "jackson2006long"

\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "guggenmos2013restoration"

\end_inset

.
 The main problem of recording-stimulation systems is the asymmetry between
 the two modalities.
 While for recordings it is relatively easy to reach a single-neuron discriminat
ion by using spike sorting techniques, in stimulation tens or hundreds of
 μA are injected (or drawn) from electrodes and they spread radially in
 all directions.
 This results in a diffuse activation of neurons surrounding the stimulation
 site.
 [Rebesco] demonstrated that with spike-triggered stimulation not only the
 connection between trigger and target neurons was strengthened, but also
 many non-target connections were affected and the entire neural network
 of recorded neurons changed its behavior.
 When studying neuroplasticity, it is definitely of great importance to
 be as selective as possible in order to be able to limit parasitic effect
 and to have a better controlled environment.
 
\end_layout

\begin_layout Standard
Recent studies have demonstrated that HD MEA allow to extract important
 information on the neuron's position and geometry.
 In 
\begin_inset CommandInset citation
LatexCommand cite
key "ruz2014localising"

\end_inset

, 144 neurons were localized (soma position)
\emph on
 in-vivo
\emph default
 with a 32 electrode MEA with 22-25 μm pitch.
 From another recent work 
\begin_inset CommandInset citation
LatexCommand cite
key "muller2015high"

\end_inset

 performed with HD MEA (17.5 μm pitch)
\emph on
 in-vitro
\emph default
, not only neurons were localized, but axonal arbors were reconstructed
 using the redundancy of recordings and spike-triggered average.
 Certainly, 
\emph on
in-vivo
\emph default
 recordings are more noisy and less controllable, but it may be possible
 to exploit HD MEA to estimate the position of neurons surrounding the MEA
 and also to estimate the direction of propagation of the axon hillock.
 In this work we assume that the previous information is available and we
 exploit the MEA to tailor stimulation spatial patterns to be as selective
 and as effective as possible with respect to the neuronal 
\emph on
scenario
\emph default
.
 The goal is to show that spatial patterns can be optimized in order to
 depolarize specific target neurons, while not activating surrounding neurons.
 We show that it is possible to selectively activate target neurons and
 that the optimized spatial pattern outperforms the standard monopolar and
 bipolar stimulation in terms of robustness.
 The main limitation of this approach, though, is that in order to keep
 optimization fast and implementable online, simple models are used for
 the MEA stimulation, which introduce estimation errors, that should be
 quantified with more sophisticated models.
\end_layout

\begin_layout Standard
The article is organized as follows: Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Methods"

\end_inset

 describes the methods involved in modeling, optimization, and simulation,
 Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Results"

\end_inset

 presents the results, and Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Discussions-and-Conclusion"

\end_inset

 discusses the relevant findings and concludes the paper.
\end_layout

\begin_layout Section
Methods
\begin_inset CommandInset label
LatexCommand label
name "sec:Methods"

\end_inset


\end_layout

\begin_layout Subsection
Modeling
\begin_inset CommandInset label
LatexCommand label
name "sub:Modeling"

\end_inset


\end_layout

\begin_layout Standard
The computational framework for performing the simulations was completely
 developed in Python, using custom models for the MEA and LFPy 
\begin_inset CommandInset citation
LatexCommand cite
key "einevoll2014lfpy"

\end_inset

, based on Neuron 
\begin_inset CommandInset citation
LatexCommand cite
key "carnevale2006neuron"

\end_inset

, for the simulation of neural activation and responses.
\end_layout

\begin_layout Standard
The 
\series bold
MEA
\series default
 was modeled as a NxN grid of monopolar current sources on a semi-infinite
 plane, with a pitch of 15 μm, resembling the prototype described in [thewes].
 The semi-infinite plane approximation is due to the fact that electrodes
 lie on a shank, facing the neural tissue only from one side.
 The potential at position 
\begin_inset Formula $\vec{r}$
\end_inset

 is 
\begin_inset Formula 
\[
V(\vec{r})=\sum_{i}\frac{I_{i}}{2\pi\sigma\left|\vec{r}-\vec{r}_{i}\right|}
\]

\end_inset


\begin_inset Newline newline
\end_inset

where 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\vec{r}_{i}$
\end_inset

 and 
\begin_inset Formula $I_{i}$
\end_inset

 are the position and current of the i-th electrode and 
\begin_inset Formula $\sigma$
\end_inset

 is the conductivity of the tissue, assumed to be isotropic and homogeneous.
 
\end_layout

\begin_layout Standard
The 
\series bold
neurons 
\series default
were modeled in a different way for evaluation and optimization.
 First, we used a simple neuronal model with a dendrite (L=100 μm, D = 1
 μm), a soma (L=19 μm, D = 19 μm), a cone-shaped axon hillock (L=10 μm,
 D = from 19 to 1 μm), and an axon tract (L=90 μm, D = 1 μm).
 When the neuron is modeled with the cable equation, the effective de/hyperpolar
ization can be predicted with the so called acivation function AF 
\begin_inset CommandInset citation
LatexCommand cite
key "rattay1990electrical"

\end_inset

, which is the second order derivative of the external potential along the
 neuron's direction scaled by the squared of the space constant (
\begin_inset Formula $AF=\lambda^{2}\frac{\partial^{2}V_{e}}{\partial x^{2}}$
\end_inset

).
 A test neurons was placed at 15 μm from a monopolar electrode coincident
 with the center of the soma, or two bipolar electrodes, with the cathode
 (negative current) coincident with the soma and the anode (positive) in
 the axon direction.
 Different current intensities were then applied with a monophasic 100 μs
 pulse and the minimum AF (for the rest of the paper we will refer to AF
 as the second derivative only, withouth the 
\begin_inset Formula $\lambda^{2}$
\end_inset

 scaling) required to generate a spike was 
\emph on
empirically 
\emph default
evaluated and served as activation threshold for the optimization step.
\end_layout

\begin_layout Standard
For optimization of the spatial pattern a neuron is represented by a single
 segment starting from the soma location, with the direction of the axon
 hillock.
 Hence, a 
\emph on
geometric neuron
\emph default
 consists of a 3D point (soma), an alignment (axon hillock direction), and
 a length (which was set to 15 μm).
 The optimization searches for solutions (current values on the different
 electrodes) that excite the target neuron and keeps the surrounding neurons
 at rest.
\end_layout

\begin_layout Subsection
Optimization
\begin_inset CommandInset label
LatexCommand label
name "sub:Optimization"

\end_inset


\end_layout

\begin_layout Standard
The optimization framework is implemented using DEAP package 
\begin_inset CommandInset citation
LatexCommand cite
key "fortin2012deap"

\end_inset

.
 Genetic algorithms perform optimization with a stochastic approach, by
 randomly sampling the solution space (in this case the currents to be assigned
 to each electrode) and evaluating them with a fitness function.
 This approach has been selected for its speed and customizability.
 The fitness function plays a very important role and represents the key
 to achieve a good optimization.
 Let us summarize the objectives of stimulation: the first objective is
 depolarizing the target neuron by applying an AF above threshold with a
 safety margin.
 At the same time we want to find a spatial pattern that does not generate
 spikes on non-target neurons.
 Second, we encourage sparse and energy efficient solution, for it would
 be easier to implement and low power.
 This said, the fitness function is in the form of:
\begin_inset Formula 
\[
\begin{cases}
f_{1}=\alpha x_{target}+(1-\alpha)x_{surround}\\
f_{2}=\beta x_{sparsity}+(1-\beta)x_{energy}
\end{cases}
\]

\end_inset


\begin_inset Newline newline
\end_inset

where 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $x_{target}$
\end_inset

 is a hinge loss-like function that penalizes points of target neurons whose
 AF is below the activation threshold; 
\begin_inset Formula $x_{surround}$
\end_inset

 penalizes points of non-target neurons whose AF is above the non-activation
 threshold, 
\begin_inset Formula $x_{sparsity}$
\end_inset

 and 
\begin_inset Formula $x_{energy}$
\end_inset

 represent the normalized (between 0 and 1) sparsity of the solution (zero-curre
nt electrodes/total electrodes) and energy efficiency (sum of absolute currents/
maximum deliverable currrent).

\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 The 2 objectives (
\begin_inset Formula $f_{1}$
\end_inset

 and 
\begin_inset Formula $f_{2}$
\end_inset

) are maximized with the same weight, so that the solution will then represent
 a trade-off among these two objectives.
 The parameters 
\begin_inset Formula $\alpha$
\end_inset

 and 
\begin_inset Formula $\beta$
\end_inset

 can be adjusted to prefer favor target activation VS non-target inactivation
 and sparsity VS energy efficiency.
 In order to keep in mind a possible physical implementation of the system,
 some constraints on the value of currents have been added.
 In particular the currents can go from -20 μA to +20 μA , but the can only
 have 2 μA steps; therefore currents can have 21 different values, but a
 negative current would be the opposite of the positive one, so only 10
 values (excluding 0) can be generated.
\end_layout

\begin_layout Standard
Selection of the solutions to be mated was performed with a selection tournament
 approach.
 Two-point crossover was used as crossover operator and crossover was applied
 with 80% probability.
 Mutation was applied to 10% of the population and it consisted of 2 steps:
 in the first step a gaussian mutation was applied with 20% probability
 to each current value; then, in order to favor sparse solution 20% of the
 current values were randomly set to 0 to favor energy efficient solutions.
 The best solutions of each iteration were always kept in the offspring.
 The genetic algorithm was run for 300 generations and it was stopped after
 100 generations of stall.
\end_layout

\begin_layout Subsection
Simulation
\end_layout

\begin_layout Standard
In order to compare the performance of the optimized spatial pattern with
 respect to conventional monopolar and bipolar approaches, 1000 
\emph on
scenarios
\emph default
 were simulated and different figures of merit were computed.
 In the proximity of a 4x4 MEA (in the 
\emph on
y-z
\emph default
 plane, centered at (0, 0, 0)) one target neuron and 4 surrounding neuron
 were placed randomly between 5 and 30 μm distance from the MEA (
\emph on
x
\emph default
 direction) with the constraint of the somas of adjacent neurons being greater
 than 15 μm.
 The alignment of the axon hillock was random in the 
\emph on
y
\emph default
 and 
\emph on
z 
\emph default
direction and it was 0 in the 
\emph on
x 
\emph default
direction (neurons are assumed to be parallel to the MEA plane).
 Three different stimulation approaches were compared: the genetetic algorithm
 (GA) optimized spatial pattern, the monopolar stimulation (MONO), in which
 the closest electrode to the mid point of the neuron was set to -10 μA,
 and the bipolar stimulation (BI), in which the closest electrode to the
 end point of the neuron was set to +10 μA and added to the monopolar electrode.
\end_layout

\begin_layout Standard
The GA optimization for each scenario was run as described in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Optimization"

\end_inset

 using an activation threshold of 1.5 mV
\begin_inset Formula $^{2}$
\end_inset

/μm
\begin_inset Formula $^{2}$
\end_inset

, a non activation threshold of 0.5 mV
\begin_inset Formula $^{2}$
\end_inset

/μm
\begin_inset Formula $^{2}$
\end_inset

, an 
\begin_inset Formula $\alpha$
\end_inset

 of 0.4 and a 
\begin_inset Formula $\beta$
\end_inset

 of 0.5.
 The activation threshold was chosen based on the empirical evaluation described
 in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Modeling"

\end_inset

, which showed that a second derivative of the potential along the neuron
 of 1.5 mV
\begin_inset Formula $^{2}$
\end_inset

/μm
\begin_inset Formula $^{2}$
\end_inset

 consistently generates spikes in both monopolar and bipolar configurations.
 Moreover, the target neuron was constrained to be 
\emph on
close 
\emph default
to the MEA, between 5 and 15 μm.
\end_layout

\begin_layout Section
Results
\begin_inset CommandInset label
LatexCommand label
name "sec:Results"

\end_inset


\end_layout

\begin_layout Subsection
Sample Scenario
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align left
\begin_inset Graphics
	filename figure_1a.tif
	lyxscale 20
	scale 20

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:neurons_and_field"

\end_inset


\emph on
Top:
\emph default
 Target neuron (red) and surrounding neurons (grey) with MEA.
 Colors are current amplitudes.
 
\emph on
Middle:
\emph default
 Potential surface at 
\emph on
x 
\emph default
= 15 μm.
 
\emph on
Bottom: 
\emph default
2D projection of potential, MEA, and neurons.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
First of all, let us analyze one of the random 
\emph on
scenarios
\emph default
.
 The top panel of Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:neurons_and_field"

\end_inset

 shows the 3D position and direction of the neurons, as well as the MEA
 electrode locations.
 The larger cylinders represent the somas, while the narrower ones are the
 axon hillock direction.
 It can be noticed how the configuration can be intricated and tangled,
 depending on the relative alignment between the target and surrounding
 neurons and their relative distance.
 The colors on the MEA depicts the intentisies of the applied currents.
 In the central panel the potential generated by the MEA on the plane (15
 μm,
\emph on
 x
\emph default
, 
\emph on
y
\emph default
) is displayed as a 3D surface.
 It can be appreciated how troughs and hills are shaped so that the target
 neuron falls in a positive AF region, while the surrounding neurons do
 not.
 The bottom panel shows a contour plot of the field and the projection of
 the neurons on the MEA plane (0, 
\emph on
x
\emph default
, 
\emph on
y
\emph default
) and the 2D projection o the neurons on the same plane.
 
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figure_1b.tif
	lyxscale 30
	scale 20

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
 
\begin_inset CommandInset label
LatexCommand label
name "fig:af_trg_surr"

\end_inset

AF trend along the neuron for the target neuron (red) and the surrounding
 neurons (gray)
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:af_trg_surr"

\end_inset

 shows the trends of the AF for the target neuron (red) and surrounding
 neurons (grey).
 It is clear that the optimized spatial pattern, for this 
\emph on
scenario
\emph default
, is able to pull the AF above the activation threshold almost for all the
 points of the target neuron and to keep the non-target neurons' AF below
 the threshold with a relatively large margin.
 However, it should be noticed that there is a lot of variability among
 
\emph on
scenarios
\emph default
 and not always the GA achieves the objectives.
 Nevertheless, even if the threshold is not reached, the target neuron's
 AF is pulled as up as possible as long as the surrounding neurons are kept
 at rest.
\end_layout

\begin_layout Subsection
GA, Monopolar, and Bipolar Comparison
\end_layout

\begin_layout Standard
The performance of stimulation concerns both the activation of the target
 neuron and the non-activation of the non-target neurons.
 In each scenario, the AF is computed on 15 points (every 1 μm), hence for
 every 
\emph on
scenario 
\emph default
different metrics are computed from the AF of each neuron.
 In Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:trg"

\end_inset

 the average of each of these values among the entire 1000 
\emph on
scenarios 
\emph default
for the target neuron is shown.
 The mean and median values are greater for GA than for MONO and BI, while
 the maximum is less, implying that the AF trend is more constant for GA.
 Moreover, the last column shows the percent of 
\emph on
scenarios
\emph default
 in which the maximum AF value is above threshold, i.e.
 the target is activated.
 The GA pattern is able to stimulate the neuron in 75.9% of the cases, way
 more than the monopolar (33.5%) and bipolar (31.5%) cases.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement t
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="7">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Target
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
mean
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
median
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
max
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
min
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
sd
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
%max>threshold
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
GA
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
1.88
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
1.81
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
2.37
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
1.28
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.36
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size footnotesize
75.9%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
MONO
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.91
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.41
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
2.81
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
-0.43
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
1.13
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
33.5%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
BI
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.67
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.21
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
2.81
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
-1.27
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
1.38
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
31.5%
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:trg"

\end_inset

 Performance on target neuron
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
In order to evaluate the selectivity of the stimulation we consider the
 worst case, which is the maximum AF value among the 4 surrounding neurons.
 If this value gets closer to the activation threshold, then it is likely
 that a spurious spike is generated on a non-target neuron.
 In Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:surr"

\end_inset

 the statistics of the maximum values among the non-target neurons are displayed.
 The values are overall smaller for the GA approach, especially the maximum
 value of the AF.
 From the last column, which shows the percentage of surroundingt neurons
 whose AF reaches the activation threshold of 1.5 mV
\begin_inset Formula $^{2}$
\end_inset

/μm
\begin_inset Formula $^{2}$
\end_inset

, it can be appreciated how the GA is more robust than MONO and BI, since
 it pulls non-target neurons above threshold only in 7.3% of the cases, compared
 to the 30.9% of the monopolar approach and the 38.2% of the bipolar one.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement b
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="7">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Non-Target
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
mean
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
median
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
max
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
min
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
sd
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
%max>threshold
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
GA
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.27
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.08
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.94
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size footnotesize
7.3%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
MONO
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.73
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.29
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
2.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.11
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.89
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
30.9%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
BI
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.77
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.23
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
2.44
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
1.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
38.2%
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:surr"

\end_inset

 Performance on non-target neurons
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ga_mono_bi"

\end_inset

 displays the boxplots of the distributions of the maximum surround AF (the
 same values shown in 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:surr"

\end_inset

), divided between the 3 approaches (GA, MONO, BI).
 The higher selectivity and robustness of the GA stimulation is reflected
 in the less number of outliers, which means that in less cases spurious
 spikes are generated.
 Moreover, the values of the AF above the activation threshold (1.5 mV
\begin_inset Formula $^{2}$
\end_inset

/μm
\begin_inset Formula $^{2}$
\end_inset

) are higher for MONO and BI approach, due to their lower adaptation to
 the environment, especially to the surrounding neurons position.
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figure_3_crop.tif
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ga_mono_bi"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The improved selectivity of course comes at a cost: in order to shape the
 potential so that only the target neuron gets activated, more electrodes
 are active at the same time, making the GA approach less efficient than
 monopolar and bipolar stimulation (active electrode =, total delivered
 current = ) and more difficult to implement.
 Nevertheless, the constraint on deliverable currents (2 μA) and the favor
 for sparse solutions allow to find spatial patterns which are not too complex
 and could be implemented from a real system.
 It should be emphasized that the GA converges to a monopolar- or bipolar-like
 solution when the 
\emph on
scenario
\emph default
 is not too complex, thanks to to sparsity and energy efficiency term in
 the fitness function.
\end_layout

\begin_layout Section
Discussions and Conclusion
\begin_inset CommandInset label
LatexCommand label
name "sec:Discussions-and-Conclusion"

\end_inset


\end_layout

\begin_layout Standard
In this study we presented a novel approach to exploit the high density
 of MEA for improving stimulation selectivity and adaptation.
 We showed that the proposed method is more selective and robust than standard
 monopolar and bipolar approaches, even if it would require more energy
 consumption and a more complex control.
 
\end_layout

\begin_layout Standard
In order to speed up the optimization and possibly make it implementable
 also in an online setup, we used a simple model for the MEA (monopolar
 approximation).
 Clearly, the geometry of the electrodes play an important role; hence,
 the error between the monopolar current source approximation and a more
 accurate method, such as a Finite Element Methods (which has been applied
 to MEA in 
\begin_inset CommandInset citation
LatexCommand cite
key "joucla2013current"

\end_inset

), should be characterized for an 
\emph on
a-posteriori 
\emph default
evaluation.
 
\end_layout

\begin_layout Standard
Moreover, we assumed to be able to estimate the exact position of the neurons'
 somas and to be able their axon hillock direction from recorded data.
 This is definitely a strong assumption, but previous studies showed that
 HD MEA are capable of providing such information 
\begin_inset CommandInset citation
LatexCommand cite
key "ruz2014localising"

\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "muller2015high"

\end_inset

.
 Nevertheless, the estimation error involved in this step should be evaluated
 as well, and our future work will deal with the entire loop: from recorded
 data, to position and direction estimation, to stimulation and evaluation
 of the outcome on more complex neural models, as well as 
\emph on
in-vivo
\emph default
.
\end_layout

\begin_layout Standard
In conlusion, we introduced an optimization approach for neural stimulation
 with HD MEA, which could lead to the capability of robustly targeting single
 neurons with extra-cellular electrical stimulation.
\end_layout

\begin_layout Section
Acknowledgments
\end_layout

\begin_layout Standard
We would like to thank Solveig Næss, for her support and pretious codes
 that she made available to us.
 Alessio Paolo Buccino and Tristan Stöber are doctoral fellows in the Simula-UCS
D-University of Oslo Research and PhD training (SUURPh) program, an internationa
l collaboration in computational biology and medicine funded by the Norwegian
 Ministry of Education and Research.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "references2"
options "IEEEtran"

\end_inset


\end_layout

\end_body
\end_document
